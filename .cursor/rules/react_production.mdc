---
description: Reglas para desarrollo seguro de componentes React en producciÃ³n
globs: src/**/*.tsx, src/**/*.ts
alwaysApply: true
---

# âš›ï¸ **REGLAS DE REACT EN PRODUCCIÃ“N**

## **âš ï¸ CONTEXTO CRÃTICO**

- **AplicaciÃ³n React en PRODUCCIÃ“N con usuarios reales**
- **Componentes que manejan datos de usuarios reales**
- **NUNCA romper funcionalidad existente**

---

## **ğŸ”’ PRINCIPIOS DE DESARROLLO SEGURO**

### **âœ… PRINCIPIOS SEGUROS:**

- **Agregar funcionalidad** sin modificar existente
- **Mantener retrocompatibilidad** con componentes existentes
- **Preservar comportamiento** de usuarios actuales
- **Crear nuevos componentes** en lugar de modificar existentes

### **âŒ PRINCIPIOS PELIGROSOS:**

- **Modificar componentes existentes** sin verificar impacto
- **Cambiar props** de componentes en uso
- **Eliminar funcionalidad** existente
- **Romper interfaces** de componentes

---

## **ğŸ›¡ï¸ PATRONES DE COMPONENTES SEGUROS**

### **âœ… Crear nuevos componentes (SEGURO):**

```tsx
// âœ… SEGURO: Crear nuevo componente para nueva funcionalidad
export const WatchlistMovieCard = ({ item, config, watchlistId, onRemove }) => {
  // Nueva funcionalidad sin afectar existente
  return <Card>{/* Contenido del nuevo componente */}</Card>;
};
```

### **âœ… Extender componentes existentes (SEGURO):**

```tsx
// âœ… SEGURO: Agregar nuevas props opcionales
export const MediaCard = ({
  item,
  config,
  showActions = false, // Nueva prop opcional
  onAction = () => {}, // Nueva prop opcional
}) => {
  return (
    <Card>
      {/* Contenido existente */}
      {showActions && (
        <CardFooter>{/* Nueva funcionalidad opcional */}</CardFooter>
      )}
    </Card>
  );
};
```

### **âŒ Modificar componentes existentes (PELIGROSO):**

```tsx
// âŒ PELIGROSO: Cambiar props existentes
export const MediaCard = ({
  item,
  config,
  // âŒ Cambiar nombre de prop existente
  onRemoveItem, // Era onRemove antes
}) => {
  // Esto romperÃ­a componentes que usan onRemove
};
```

---

## **ğŸ” VALIDACIÃ“N DE CAMBIOS EN COMPONENTES**

### **Checklist obligatorio antes de modificar:**

- [ ] **Â¿El componente se usa en producciÃ³n?** â†’ Verificar impacto
- [ ] **Â¿Se cambian props existentes?** â†’ âŒ PELIGROSO
- [ ] **Â¿Se elimina funcionalidad existente?** â†’ âŒ PELIGROSO
- [ ] **Â¿Se agrega nueva funcionalidad opcional?** â†’ âœ… Seguro
- [ ] **Â¿Se crea nuevo componente?** â†’ âœ… Seguro

### **Componentes crÃ­ticos identificados:**

```tsx
// Componentes que manejan datos de usuarios reales:
- MediaCard.tsx â†’ Muestra pelÃ­culas de usuarios
- WatchlistList.tsx â†’ Lista watchlists de usuarios
- WatchlistItem.tsx â†’ Items de watchlists de usuarios
- WatchlistDetail.tsx â†’ Detalle de watchlist de usuarios
- AuthForm.tsx â†’ AutenticaciÃ³n de usuarios
- ProtectedRoute.tsx â†’ ProtecciÃ³n de rutas
```

---

## **ğŸ“‹ ESTRUCTURA DE COMPONENTES ACTUAL**

### **Componentes existentes (VERIFICAR IMPACTO):**

```tsx
// src/components/movies/
MediaCard.tsx
â”œâ”€â”€ Props: item, config
â”œâ”€â”€ Funcionalidad: Mostrar pelÃ­cula/serie
â””â”€â”€ Uso: En bÃºsquedas y watchlists

// src/components/watchlists/
WatchlistList.tsx
â”œâ”€â”€ Props: watchlists, onSelect
â”œâ”€â”€ Funcionalidad: Listar watchlists
â””â”€â”€ Uso: PÃ¡gina principal

WatchlistItem.tsx
â”œâ”€â”€ Props: watchlist, onSelect, onDelete
â”œâ”€â”€ Funcionalidad: Item individual de watchlist
â””â”€â”€ Uso: En WatchlistList

WatchlistDetail.tsx
â”œâ”€â”€ Props: watchlistId
â”œâ”€â”€ Funcionalidad: Detalle de watchlist
â””â”€â”€ Uso: PÃ¡gina de detalle

// src/components/auth/
AuthForm.tsx
â”œâ”€â”€ Props: type, onSuccess
â”œâ”€â”€ Funcionalidad: Login/Registro
â””â”€â”€ Uso: PÃ¡ginas de autenticaciÃ³n
```

### **Nuevos componentes (SEGURO AGREGAR):**

```tsx
// src/components/watchlists/
WatchlistMovieCard.tsx
â”œâ”€â”€ Props: item, config, watchlistId, onRemove
â”œâ”€â”€ Funcionalidad: Tarjeta de pelÃ­cula en watchlist
â””â”€â”€ Uso: En WatchlistDetail

// Nuevos componentes para nuevas funcionalidades
FavoriteButton.tsx
WatchedButton.tsx
RemoveButton.tsx
```

---

## **ğŸš¨ ALERTAS CRÃTICAS**

### **Si detectas estos patrones, DETENER inmediatamente:**

- Cambiar nombres de props existentes
- Eliminar props existentes
- Modificar comportamiento de componentes en uso
- Cambiar interfaces de componentes existentes
- Eliminar funcionalidad existente

### **Comandos de emergencia:**

- **Detener desarrollo** si hay riesgo de romper funcionalidad
- **Informar al usuario** sobre cualquier cambio que pueda afectar usuarios
- **Sugerir testing** antes de implementar cambios
- **Validar impacto** antes de proceder

---

## **ğŸ’¡ MEJORES PRÃCTICAS**

### **Para nuevas funcionalidades:**

1. **Crear nuevos componentes** en lugar de modificar existentes
2. **Usar props opcionales** para nueva funcionalidad
3. **Mantener retrocompatibilidad** con componentes existentes
4. **Probar en entorno de desarrollo** antes de producciÃ³n

### **Para modificar componentes existentes:**

1. **Verificar impacto** en componentes que los usan
2. **Mantener interfaces existentes** intactas
3. **Agregar funcionalidad opcional** sin romper existente
4. **Documentar cambios** para otros desarrolladores

### **Para testing:**

1. **Probar componentes existentes** despuÃ©s de cambios
2. **Verificar que usuarios actuales** mantengan funcionalidad
3. **Validar nuevas funcionalidades** antes de implementar
4. **Revisar consola** para errores despuÃ©s de cambios

---

## **ğŸ”§ HERRAMIENTAS DE VALIDACIÃ“N**

### **Antes de hacer cambios:**

```bash
# Verificar que la aplicaciÃ³n compile
npm run build

# Verificar que no haya errores de TypeScript
npm run type-check

# Verificar que no haya errores de linting
npm run lint
```

### **DespuÃ©s de hacer cambios:**

```bash
# Verificar que la aplicaciÃ³n funcione
npm run dev

# Verificar que no haya errores en consola
# Revisar funcionalidad existente
# Probar nuevas funcionalidades
```

---

**ğŸ¯ OBJETIVO: Mantener la funcionalidad existente de usuarios reales mientras se agregan nuevas caracterÃ­sticas de manera segura y sin interrupciones.**
